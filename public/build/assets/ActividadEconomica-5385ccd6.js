import{r as n,j as u,a as c,F as N}from"./app-e092db3c.js";const ai=({subcategorias:V,id:D,nameBuscador:H,onHandleSectores:K,tipo:k,checkeds:z})=>{const[l,ii]=n.exports.useState(V),[I,O]=n.exports.useState(V),[E,S]=n.exports.useState([]),[x,C]=n.exports.useState([]),[G,J]=n.exports.useState([]);n.exports.useEffect(()=>{var e=[];l.forEach(i=>{if(i.childs.length>0){var a=[],s=[];i.id_padre_sub_categoria==null&&(i.childs.forEach(d=>{a.push(d.id);var r=l.filter(o=>o.id==d.id)[0];r.childs.length>0&&r.childs.forEach(o=>{s.push(o.id)})}),e[i.id]=["sectores"],e[i.id].segmentos=a,e[i.id].actividades_economicas=s)}}),J(e)},[]);const[h,B]=n.exports.useState(z),[A,L]=n.exports.useState([]),[w,j]=n.exports.useState([]),Q=e=>{var i=document.getElementById("sector_"+e);i.classList.toggle("expanded"),E.includes(e)?S(E.filter(d=>d!=e)):S([...E,e]);const a=new RegExp(e,"i");I.filter(function(d){if(a.test(d.id_padre_sub_categoria))return d}).forEach(d=>{if(!A.includes(d))A.push(d);else{const r=A.filter(o=>o.id_padre_sub_categoria!=e);L(r)}})},U=e=>{var i=document.getElementById("segmento_"+e);i.classList.toggle("expanded"),x.includes(e)?C(x.filter(d=>d!=e)):C([...x,e]);const a=new RegExp(e,"i");I.filter(function(d){if(a.test(d.id_padre_sub_categoria))return d}).forEach(d=>{if(!w.includes(d))w.push(d);else{const r=w.filter(o=>o.id_padre_sub_categoria!=e);j(r)}})},$=e=>{var i=[];h.forEach(d=>{i.push(d)});var a=l.filter(d=>d.id_padre_sub_categoria==e.id&&d.id_abuelo_sub_categoria==null);if(a.length>0)i.includes(e.id)?(i=g(i,e.id),i=m(i,a,"segmento","remove")):(i.push(e.id),i=m(i,a,"segmento","remove"),i=m(i,a,"segmento","add"));else{var s=l.filter(d=>d.id_padre_sub_categoria==e.id);s.length>0?i.includes(e.id)?(i=g(i,e.id),i=m(i,s,"actividad_economica","remove")):(i.push(e.id),i=m(i,s,"actividades_economicas","remove"),i=m(i,s,"actividad_economica","add")):i.includes(e.id)?i=g(i,e.id):i.push(e.id)}i=[...new Set(i)],B(i),W(i,e)},W=(e,i)=>{if(b(i.id,"actividades_economicas")){var a=P(e,"actividades_economicas"),s=T(a,i,"actividades_economicas"),d=s[0],r=s[1],o=!0,p=0,t=R(i.id_padre_sub_categoria,"actividades_economicas");t.forEach(f=>{a.includes(f)?p+=1:o=!1}),o?(e.push(i.id_padre_sub_categoria),_("segmento_check_"+i.id_padre_sub_categoria,"remove")):(e=g(e,i.id_padre_sub_categoria),e=g(e,i.id_abuelo_sub_categoria),B(e),p>0?_("segmento_check_"+i.id_padre_sub_categoria,"add"):_("segmento_check_"+i.id_padre_sub_categoria,"remove"),r>0?_("sector_check_"+i.id_abuelo_sub_categoria,"add"):_("sector_check_"+i.id_abuelo_sub_categoria,"remove")),d&&e.push(i.id_abuelo_sub_categoria)}if(b(i.id,"segmentos")){var F=P(e,"segmentos"),s=T(F,i,"segmentos"),d=s[0],r=s[1];d?e.push(i.id_padre_sub_categoria):(e=g(e,i.id_padre_sub_categoria),B(e),r>0?_("sector_check_"+i.id_padre_sub_categoria,"add"):(_("sector_check_"+i.id_padre_sub_categoria,"remove"),_("segmento_check_"+i.id,"remove")))}if(b(i.id,"sector")){_("sector_check_"+i.id,"remove");var v=R(i.id,"segmentos");v.forEach(f=>{_("segmento_check_"+f,"remove")})}},R=(e,i)=>{var a=[];return l.forEach(s=>{switch(i){case"actividades_economicas":s.id_padre_sub_categoria==e&&a.push(s.id);break;case"segmentos":s.id_padre_sub_categoria==e&&a.push(s.id);break}}),a},P=(e,i)=>{var a=[];return e.forEach(s=>{b(s,i)&&a.push(s)}),a},b=(e,i)=>{var a=l.filter(s=>s.id==e)[0];switch(i){case"actividades_economicas":return a.id_abuelo_sub_categoria!=null&&a.id_padre_sub_categoria!=null?a:!1;case"segmentos":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria!=null?a:!1;case"sector":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria==null?a:!1}},T=(e,i,a)=>{var s=!0,d=0;if(e.length>0){var r=l.filter(p=>p.id==i.id)[0],o=0;switch(a){case"actividades_economicas":o=r.id_abuelo_sub_categoria;break;case"segmentos":o=r.id_padre_sub_categoria;break;case"sector":o=r.id;break}G[o][a].forEach(p=>{e.includes(p)?d+=1:s=!1})}else s=!1;return[s,d]},_=(e,i)=>{var a=document.getElementById(e);i=="add"?a&&a.classList.add("check-minus"):a&&a.classList.remove("check-minus")},g=(e,i)=>{const a=e.indexOf(i);return a>-1&&e.splice(a,1),e},m=(e,i,a=null,s)=>(i.forEach(d=>{switch(s){case"add":e.push(d.id),a=="segmento"&&l.filter(o=>o.id_padre_sub_categoria==d.id).forEach(o=>{e.push(o.id)});break;case"remove":e=g(e,d.id),a=="segmento"&&l.filter(o=>o.id_padre_sub_categoria==d.id).forEach(o=>{e=g(e,o.id)});break}}),e),X=e=>{if(e.target.value==""){O(l),L([]),j([]),S([]),C([]);return}if(e.key==="Enter"){const o=new RegExp(e.target.value,"i"),p=l.filter(function(t){if(o.test(t.nombre)||e.target.value==t.id)return t});var i=[],a=[],s=[],d=[],r=[];p.forEach(t=>{if(t.id_abuelo_sub_categoria!=null&&t.id_padre_sub_categoria!=null){s.push(t);var F=l.filter(f=>f.id==t.id_padre_sub_categoria)[0];a.includes(F)||a.push(F),d.includes(t.id_padre_sub_categoria)||d.push(t.id_padre_sub_categoria);var v=l.filter(f=>f.id==t.id_abuelo_sub_categoria)[0];i.includes(v)||i.push(v),r.includes(t.id_abuelo_sub_categoria)||r.push(t.id_abuelo_sub_categoria)}if(t.id_abuelo_sub_categoria==null&&t.id_padre_sub_categoria!=null){a.includes(t)||a.push(t),d.includes(t.id)||d.push(t.id);var v=l.filter(y=>y.id==t.id_padre_sub_categoria)[0];i.includes(v)||i.push(v),r.includes(t.id_padre_sub_categoria)||r.push(t.id_padre_sub_categoria)}t.id_abuelo_sub_categoria==null&&t.id_padre_sub_categoria==null&&(i.includes(t)||i.push(t),r.includes(t.id)||r.push(t.id))}),O(i),L(a),j(s),S(r),C(d)}};n.exports.useEffect(()=>{K(h,k)},[h]);const[q,Y]=n.exports.useState([]);n.exports.useEffect(()=>{Z()},[h]);const Z=()=>{let e=[];h.forEach(i=>{if(b(i,"actividades_economicas")){var a=M(i);e.push(a.id);var s=M(a.id);e.push(s.id)}if(b(i,"segmentos")){var s=M(i);e.push(s.id)}}),e=[...new Set(e)],Y(e)},M=e=>{var i=l.filter(s=>s.id==e)[0],a=l.filter(s=>s.id==i.id_padre_sub_categoria)[0];return a};return u("div",{id:"SubCategorias",children:[u("div",{className:"mx-60 mt-30 d-flex",children:[c("button",{button:!0,type:"button",className:"icon-Buscar-click"}),c("input",{type:"text",placeholder:H,autoComplete:"off",className:"form-control busqueda-input",onKeyDown:X}),u("h2",{className:"perfiles-titulos d-flex",children:[" ","Pais de contrataciÃ³n",c("img",{className:"bandera",src:"/public/images/banderas/listado_nombres/CHL.svg",alt:"Bandera Chile"})]})]}),c("br",{}),c("ul",{className:`tree-root ${k}`,id:D,children:I.map(e=>c(N,{children:e.id_padre_sub_categoria==null&&u("li",{className:`tree-node has-child draggable ${E.includes(e.id)?"expanded":""}`,id:"sector_"+e.id,children:[u("div",{id:e.id,className:"tree-content sector",children:[c("i",{className:`tree-arrow has-child ${e.childs.length>0?"ltr":""}`}),c("input",{id:"sector_check_"+e.id,class:`${q.includes(e.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>$(e),checked:h.includes(e.id)?"checked":""}),c("span",{className:"tree-anchor",children:u("span",{className:"tree-division tree-division1",onClick:()=>Q(e.id),children:[c("div",{class:"tree-division__img",children:c("img",{src:`/images/subcategorias/${e.icon}`,width:"35px"})}),c("span",{className:"tree-division__title my-auto",children:e.nombre})]})})]},e.id),E.includes(e.id)&&c("ul",{className:`tree-children ${k}`,children:A.map((i,a)=>c(N,{children:e.id==i.id_padre_sub_categoria&&u("li",{className:`tree-node has-child draggable segmento ${x.includes(i.id)?"expanded":""}`,id:"segmento_"+i.id,children:[u("div",{className:"tree-content segmento",children:[c("i",{className:"tree-arrow expanded has-child ltr"}),c("input",{id:"segmento_check_"+i.id,class:`${q.includes(i.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>$(i),checked:h.includes(i.id)?"checked":""}),c("span",{className:"tree-anchor",children:k=="ActividadEconomica"?c("span",{className:"tree-division tree-division1",onClick:()=>U(i.id),children:c("span",{className:"tree-division__title my-auto",children:i.nombre})}):c("span",{className:"tree-division tree-division1",children:c(N,{children:a%2==0?c("span",{className:"tree-division__title my-auto",children:i.nombre}):c("span",{className:"tree-division__title-gray my-auto",children:i.nombre})})})})]}),k=="ActividadEconomica"&&x.includes(i.id)&&c("ul",{className:"tree-children actividad-economica",children:w.map((s,d)=>c(N,{children:i.id==s.id_padre_sub_categoria&&c("li",{className:"tree-node draggable",children:u("div",{className:"tree-content actividad-economica",onClick:()=>$(s),children:[c("input",{type:"checkbox",name:"actividad_economica",onChange:()=>$(s),checked:h.includes(s.id)?"checked":""}),c("span",{className:"tree-anchor children",children:c("span",{className:"tree-division tree-division1",children:c(N,{children:c("span",{className:"tree-division__title my-auto",children:s.nombre})})})})]})})}))})]})}))})]})}))})]})};export{ai as A};
