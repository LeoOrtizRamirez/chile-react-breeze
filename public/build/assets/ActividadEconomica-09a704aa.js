import{r as l,j as v,a as c,F as k}from"./app-19c5e09a.js";const ae=({subcategorias:V,id:D,nameBuscador:H,onHandleSectores:K,tipo:E,checkeds:z})=>{const[n,ee]=l.exports.useState(V),[$,O]=l.exports.useState(V),[x,S]=l.exports.useState([]),[N,C]=l.exports.useState([]),[G,J]=l.exports.useState([]);l.exports.useEffect(()=>{var i=[];n.forEach(e=>{if(e.childs.length>0){var a=[],s=[];e.id_padre_sub_categoria==null&&(e.childs.forEach(d=>{a.push(d.id);var r=n.filter(o=>o.id==d.id)[0];r.childs.length>0&&r.childs.forEach(o=>{s.push(o.id)})}),i[e.id]=["sectores"],i[e.id].segmentos=a,i[e.id].actividades_economicas=s)}}),J(i)},[]);const[u,B]=l.exports.useState(z),[A,L]=l.exports.useState([]),[w,j]=l.exports.useState([]),Q=i=>{var e=document.getElementById("sector_"+i);e.classList.toggle("expanded"),x.includes(i)?S(x.filter(d=>d!=i)):S([...x,i]);const a=new RegExp(i,"i");$.filter(function(d){if(a.test(d.id_padre_sub_categoria))return d}).forEach(d=>{if(!A.includes(d))A.push(d);else{const r=A.filter(o=>o.id_padre_sub_categoria!=i);L(r)}})},U=i=>{var e=document.getElementById("segmento_"+i);e.classList.toggle("expanded"),N.includes(i)?C(N.filter(d=>d!=i)):C([...N,i]);const a=new RegExp(i,"i");$.filter(function(d){if(a.test(d.id_padre_sub_categoria))return d}).forEach(d=>{if(!w.includes(d))w.push(d);else{const r=w.filter(o=>o.id_padre_sub_categoria!=i);j(r)}})},F=i=>{var e=[];u.forEach(d=>{e.push(d)});var a=n.filter(d=>d.id_padre_sub_categoria==i.id&&d.id_abuelo_sub_categoria==null);if(a.length>0)e.includes(i.id)?(e=h(e,i.id),e=m(e,a,"segmento","remove")):(e.push(i.id),e=m(e,a,"segmento","remove"),e=m(e,a,"segmento","add"));else{var s=n.filter(d=>d.id_padre_sub_categoria==i.id);s.length>0?e.includes(i.id)?(e=h(e,i.id),e=m(e,s,"actividad_economica","remove")):(e.push(i.id),e=m(e,s,"actividades_economicas","remove"),e=m(e,s,"actividad_economica","add")):e.includes(i.id)?e=h(e,i.id):e.push(i.id)}e=[...new Set(e)],B(e),W(e,i)},W=(i,e)=>{if(b(e.id,"actividades_economicas")){var a=P(i,"actividades_economicas"),s=T(a,e,"actividades_economicas"),d=s[0],r=s[1],o=!0,p=0,t=R(e.id_padre_sub_categoria,"actividades_economicas");t.forEach(f=>{a.includes(f)?p+=1:o=!1}),o?(i.push(e.id_padre_sub_categoria),_("segmento_check_"+e.id_padre_sub_categoria,"remove")):(i=h(i,e.id_padre_sub_categoria),i=h(i,e.id_abuelo_sub_categoria),B(i),p>0?_("segmento_check_"+e.id_padre_sub_categoria,"add"):_("segmento_check_"+e.id_padre_sub_categoria,"remove"),r>0?_("sector_check_"+e.id_abuelo_sub_categoria,"add"):_("sector_check_"+e.id_abuelo_sub_categoria,"remove")),d&&i.push(e.id_abuelo_sub_categoria)}if(b(e.id,"segmentos")){var I=P(i,"segmentos"),s=T(I,e,"segmentos"),d=s[0],r=s[1];d?i.push(e.id_padre_sub_categoria):(i=h(i,e.id_padre_sub_categoria),B(i),r>0?_("sector_check_"+e.id_padre_sub_categoria,"add"):(_("sector_check_"+e.id_padre_sub_categoria,"remove"),_("segmento_check_"+e.id,"remove")))}if(b(e.id,"sector")){_("sector_check_"+e.id,"remove");var g=R(e.id,"segmentos");g.forEach(f=>{_("segmento_check_"+f,"remove")})}},R=(i,e)=>{var a=[];return n.forEach(s=>{switch(e){case"actividades_economicas":s.id_padre_sub_categoria==i&&a.push(s.id);break;case"segmentos":s.id_padre_sub_categoria==i&&a.push(s.id);break}}),a},P=(i,e)=>{var a=[];return i.forEach(s=>{b(s,e)&&a.push(s)}),a},b=(i,e)=>{var a=n.filter(s=>s.id==i)[0];switch(e){case"actividades_economicas":return a.id_abuelo_sub_categoria!=null&&a.id_padre_sub_categoria!=null?a:!1;case"segmentos":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria!=null?a:!1;case"sector":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria==null?a:!1}},T=(i,e,a)=>{var s=!0,d=0;if(i.length>0){var r=n.filter(p=>p.id==e.id)[0],o=0;switch(a){case"actividades_economicas":o=r.id_abuelo_sub_categoria;break;case"segmentos":o=r.id_padre_sub_categoria;break;case"sector":o=r.id;break}G[o][a].forEach(p=>{i.includes(p)?d+=1:s=!1})}else s=!1;return[s,d]},_=(i,e)=>{var a=document.getElementById(i);e=="add"?a&&a.classList.add("check-minus"):a&&a.classList.remove("check-minus")},h=(i,e)=>{const a=i.indexOf(e);return a>-1&&i.splice(a,1),i},m=(i,e,a=null,s)=>(e.forEach(d=>{switch(s){case"add":i.push(d.id),a=="segmento"&&n.filter(o=>o.id_padre_sub_categoria==d.id).forEach(o=>{i.push(o.id)});break;case"remove":i=h(i,d.id),a=="segmento"&&n.filter(o=>o.id_padre_sub_categoria==d.id).forEach(o=>{i=h(i,o.id)});break}}),i),X=i=>{if(i.target.value==""){O(n),L([]),j([]),S([]),C([]);return}if(i.key==="Enter"){const o=new RegExp(i.target.value,"i"),p=n.filter(function(t){if(o.test(t.nombre)||i.target.value==t.id)return t});var e=[],a=[],s=[],d=[],r=[];p.forEach(t=>{if(t.id_abuelo_sub_categoria!=null&&t.id_padre_sub_categoria!=null){s.push(t);var I=n.filter(f=>f.id==t.id_padre_sub_categoria)[0];a.includes(I)||a.push(I),d.includes(t.id_padre_sub_categoria)||d.push(t.id_padre_sub_categoria);var g=n.filter(f=>f.id==t.id_abuelo_sub_categoria)[0];e.includes(g)||e.push(g),r.includes(t.id_abuelo_sub_categoria)||r.push(t.id_abuelo_sub_categoria)}if(t.id_abuelo_sub_categoria==null&&t.id_padre_sub_categoria!=null){a.includes(t)||a.push(t),d.includes(t.id)||d.push(t.id);var g=n.filter(y=>y.id==t.id_padre_sub_categoria)[0];e.includes(g)||e.push(g),r.includes(t.id_padre_sub_categoria)||r.push(t.id_padre_sub_categoria)}t.id_abuelo_sub_categoria==null&&t.id_padre_sub_categoria==null&&(e.includes(t)||e.push(t),r.includes(t.id)||r.push(t.id))}),O(e),L(a),j(s),S(r),C(d)}};l.exports.useEffect(()=>{K(u,E)},[u]);const[q,Y]=l.exports.useState([]);l.exports.useEffect(()=>{Z()},[u]);const Z=()=>{let i=[];u.forEach(e=>{if(b(e,"actividades_economicas")){var a=M(e);i.push(a.id);var s=M(a.id);i.push(s.id)}if(b(e,"segmentos")){var s=M(e);i.push(s.id)}}),i=[...new Set(i)],Y(i)},M=i=>{var e=n.filter(s=>s.id==i)[0],a=n.filter(s=>s.id==e.id_padre_sub_categoria)[0];return a};return v("div",{id:"SubCategorias",children:[v("div",{className:"mx-60 mt-30 d-flex",children:[c("button",{button:!0,type:"button",className:"icon-Buscar-click"}),c("input",{type:"text",placeholder:H,autoComplete:"off",className:"form-control busqueda-input",onKeyDown:X}),v("h2",{className:"perfiles-titulos d-flex",children:[" ","Pais de contrataciÃ³n",c("img",{className:"bandera",src:"/public/images/banderas/listado_nombres/CHL.svg",alt:"Bandera Chile"})]})]}),c("br",{}),c("ul",{className:`tree-root ${E}`,id:D,children:$.map(i=>c(k,{children:i.id_padre_sub_categoria==null&&v("li",{className:`tree-node has-child draggable ${x.includes(i.id)?"expanded":""}`,id:"sector_"+i.id,children:[v("div",{id:i.id,className:"tree-content mt-3 sector",children:[c("i",{className:`tree-arrow has-child ${i.childs.length>0?"bi bi-chevron-down":""}`}),c("input",{id:"sector_check_"+i.id,class:`${q.includes(i.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>F(i),checked:u.includes(i.id)?"checked":""}),c("span",{className:"tree-anchor",children:c("span",{className:"tree-division tree-division1",onClick:()=>Q(i.id),children:c("span",{className:"tree-division__title my-auto",children:i.nombre})})})]},i.id),x.includes(i.id)&&c("ul",{className:`tree-children ${E}`,children:A.map((e,a)=>c(k,{children:i.id==e.id_padre_sub_categoria&&v("li",{className:`tree-node has-child draggable segmento ${N.includes(e.id)?"expanded":""}`,id:"segmento_"+e.id,children:[v("div",{className:"tree-content segmento",children:[c("i",{className:"tree-arrow expanded has-child ltr"}),c("input",{id:"segmento_check_"+e.id,class:`${q.includes(e.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>F(e),checked:u.includes(e.id)?"checked":""}),c("span",{className:"tree-anchor",children:E=="ActividadEconomica"?c("span",{className:"tree-division tree-division1",onClick:()=>U(e.id),children:c(k,{children:a%2==0?c("span",{className:"tree-division__title my-auto",children:e.nombre}):c("span",{className:"tree-division__title-gray my-auto",children:e.nombre})})}):c("span",{className:"tree-division tree-division1",children:c(k,{children:a%2==0?c("span",{className:"tree-division__title my-auto",children:e.nombre}):c("span",{className:"tree-division__title-gray my-auto",children:e.nombre})})})})]}),E=="ActividadEconomica"&&N.includes(e.id)&&c("ul",{className:"tree-children actividad-economica",children:w.map((s,d)=>c(k,{children:e.id==s.id_padre_sub_categoria&&c("li",{className:"tree-node draggable",children:v("div",{className:"tree-content actividad-economica",onClick:()=>F(s),children:[c("input",{type:"checkbox",name:"actividad_economica",onChange:()=>F(s),checked:u.includes(s.id)?"checked":""}),c("span",{className:"tree-anchor children",children:c("span",{className:"tree-division tree-division1",children:c(k,{children:c("span",{className:"tree-division__title my-auto",children:s.nombre})})})})]})})}))})]})}))})]})}))})]})};export{ae as A};
