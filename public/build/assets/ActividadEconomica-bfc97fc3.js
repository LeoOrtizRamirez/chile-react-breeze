import{r as l,j as g,a as d,F as S}from"./app-323e22de.js";const ai=({subcategorias:V,id:D,nameBuscador:y,onHandleSectores:K,tipo:b,checkeds:U})=>{const[n,ii]=l.exports.useState(V),[I,O]=l.exports.useState(V),[E,N]=l.exports.useState([]),[x,C]=l.exports.useState([]),[z,G]=l.exports.useState([]);l.exports.useEffect(()=>{var e=[];n.forEach(i=>{if(i.childs.length>0){var a=[],s=[];i.id_padre_sub_categoria==null&&(i.childs.forEach(c=>{a.push(c.id);var r=n.filter(o=>o.id==c.id)[0];r.childs.length>0&&r.childs.forEach(o=>{s.push(o.id)})}),e[i.id]=["sectores"],e[i.id].segmentos=a,e[i.id].actividades_economicas=s)}}),G(e)},[]);const[u,B]=l.exports.useState(U),[A,j]=l.exports.useState([]),[w,L]=l.exports.useState([]),H=e=>{var i=document.getElementById("sector_"+e);i.classList.toggle("expanded"),E.includes(e)?N(E.filter(c=>c!=e)):N([...E,e]);const a=new RegExp(e,"i");I.filter(function(c){if(a.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!A.includes(c))A.push(c);else{const r=A.filter(o=>o.id_padre_sub_categoria!=e);j(r)}})},J=e=>{var i=document.getElementById("segmento_"+e);i.classList.toggle("expanded"),x.includes(e)?C(x.filter(c=>c!=e)):C([...x,e]);const a=new RegExp(e,"i");I.filter(function(c){if(a.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!w.includes(c))w.push(c);else{const r=w.filter(o=>o.id_padre_sub_categoria!=e);L(r)}})},$=e=>{var i=[];u.forEach(c=>{i.push(c)});var a=n.filter(c=>c.id_padre_sub_categoria==e.id&&c.id_abuelo_sub_categoria==null);if(a.length>0)i.includes(e.id)?(i=h(i,e.id),i=k(i,a,"segmento","remove")):(i.push(e.id),i=k(i,a,"segmento","remove"),i=k(i,a,"segmento","add"));else{var s=n.filter(c=>c.id_padre_sub_categoria==e.id);s.length>0?i.includes(e.id)?(i=h(i,e.id),i=k(i,s,"actividad_economica","remove")):(i.push(e.id),i=k(i,s,"actividades_economicas","remove"),i=k(i,s,"actividad_economica","add")):i.includes(e.id)?i=h(i,e.id):i.push(e.id)}i=[...new Set(i)],B(i),Q(i,e)},Q=(e,i)=>{if(m(i.id,"actividades_economicas")){var a=P(e,"actividades_economicas"),s=T(a,i,"actividades_economicas"),c=s[0],r=s[1],o=!0,v=0,t=R(i.id_padre_sub_categoria,"actividades_economicas");t.forEach(f=>{a.includes(f)?v+=1:o=!1}),o?(e.push(i.id_padre_sub_categoria),_("segmento_check_"+i.id_padre_sub_categoria,"remove")):(e=h(e,i.id_padre_sub_categoria),e=h(e,i.id_abuelo_sub_categoria),B(e),v>0?_("segmento_check_"+i.id_padre_sub_categoria,"add"):_("segmento_check_"+i.id_padre_sub_categoria,"remove"),r>0?_("sector_check_"+i.id_abuelo_sub_categoria,"add"):_("sector_check_"+i.id_abuelo_sub_categoria,"remove")),c&&e.push(i.id_abuelo_sub_categoria)}if(m(i.id,"segmentos")){var F=P(e,"segmentos"),s=T(F,i,"segmentos"),c=s[0],r=s[1];c?e.push(i.id_padre_sub_categoria):(e=h(e,i.id_padre_sub_categoria),B(e),r>0?_("sector_check_"+i.id_padre_sub_categoria,"add"):(_("sector_check_"+i.id_padre_sub_categoria,"remove"),_("segmento_check_"+i.id,"remove")))}if(m(i.id,"sector")){_("sector_check_"+i.id,"remove");var p=R(i.id,"segmentos");p.forEach(f=>{_("segmento_check_"+f,"remove")})}},R=(e,i)=>{var a=[];return n.forEach(s=>{switch(i){case"actividades_economicas":s.id_padre_sub_categoria==e&&a.push(s.id);break;case"segmentos":s.id_padre_sub_categoria==e&&a.push(s.id);break}}),a},P=(e,i)=>{var a=[];return e.forEach(s=>{m(s,i)&&a.push(s)}),a},m=(e,i)=>{var a=n.filter(s=>s.id==e)[0];switch(i){case"actividades_economicas":return a.id_abuelo_sub_categoria!=null&&a.id_padre_sub_categoria!=null?a:!1;case"segmentos":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria!=null?a:!1;case"sector":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria==null?a:!1}},T=(e,i,a)=>{var s=!0,c=0;if(e.length>0){var r=n.filter(v=>v.id==i.id)[0],o=0;switch(a){case"actividades_economicas":o=r.id_abuelo_sub_categoria;break;case"segmentos":o=r.id_padre_sub_categoria;break;case"sector":o=r.id;break}z[o][a].forEach(v=>{e.includes(v)?c+=1:s=!1})}else s=!1;return[s,c]},_=(e,i)=>{var a=document.getElementById(e);i=="add"?a&&a.classList.add("check-minus"):a&&a.classList.remove("check-minus")},h=(e,i)=>{const a=e.indexOf(i);return a>-1&&e.splice(a,1),e},k=(e,i,a=null,s)=>(i.forEach(c=>{switch(s){case"add":e.push(c.id),a=="segmento"&&n.filter(o=>o.id_padre_sub_categoria==c.id).forEach(o=>{e.push(o.id)});break;case"remove":e=h(e,c.id),a=="segmento"&&n.filter(o=>o.id_padre_sub_categoria==c.id).forEach(o=>{e=h(e,o.id)});break}}),e),W=e=>{if(e.target.value==""){O(n),j([]),L([]),N([]),C([]);return}if(e.key==="Enter"){const o=new RegExp(e.target.value,"i"),v=n.filter(function(t){if(o.test(t.nombre)||e.target.value==t.id)return t});var i=[],a=[],s=[],c=[],r=[];v.forEach(t=>{if(t.id_abuelo_sub_categoria!=null&&t.id_padre_sub_categoria!=null){s.push(t);var F=n.filter(f=>f.id==t.id_padre_sub_categoria)[0];a.includes(F)||a.push(F),c.includes(t.id_padre_sub_categoria)||c.push(t.id_padre_sub_categoria);var p=n.filter(f=>f.id==t.id_abuelo_sub_categoria)[0];i.includes(p)||i.push(p),r.includes(t.id_abuelo_sub_categoria)||r.push(t.id_abuelo_sub_categoria)}if(t.id_abuelo_sub_categoria==null&&t.id_padre_sub_categoria!=null){a.includes(t)||a.push(t),c.includes(t.id)||c.push(t.id);var p=n.filter(Z=>Z.id==t.id_padre_sub_categoria)[0];i.includes(p)||i.push(p),r.includes(t.id_padre_sub_categoria)||r.push(t.id_padre_sub_categoria)}t.id_abuelo_sub_categoria==null&&t.id_padre_sub_categoria==null&&(i.includes(t)||i.push(t),r.includes(t.id)||r.push(t.id))}),O(i),j(a),L(s),N(r),C(c)}};l.exports.useEffect(()=>{K(u,b)},[u]);const[q,X]=l.exports.useState([]);l.exports.useEffect(()=>{Y()},[u]);const Y=()=>{let e=[];u.forEach(i=>{if(m(i,"actividades_economicas")){var a=M(i);e.push(a.id);var s=M(a.id);e.push(s.id)}if(m(i,"segmentos")){var s=M(i);e.push(s.id)}}),e=[...new Set(e)],X(e)},M=e=>{var i=n.filter(s=>s.id==e)[0],a=n.filter(s=>s.id==i.id_padre_sub_categoria)[0];return a};return g("div",{id:"SubCategorias",children:[d("div",{class:"tree_categorias__busqueda mb-3 mb-md-4",children:g("div",{class:"mx-auto",children:[d("input",{type:"text",placeholder:"Busca por actividad econÃ³mica o UNSPSC",class:"form-control",onKeyDown:W}),d("i",{class:"icon-Cancelar",style:{display:"none"}}),d("button",{type:"button",class:"icon-Buscar-click"})]})}),d("ul",{className:`tree-root ${b}`,id:D,children:I.map(e=>d(S,{children:e.id_padre_sub_categoria==null&&g("li",{className:`tree-node has-child draggable ${E.includes(e.id)?"expanded":""}`,id:"sector_"+e.id,children:[g("div",{id:e.id,className:"tree-content sector",children:[d("i",{className:`tree-arrow has-child ${e.childs.length>0?"ltr":""}`}),d("input",{id:"sector_check_"+e.id,class:`${q.includes(e.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>$(e),checked:u.includes(e.id)?"checked":""}),d("span",{className:"tree-anchor",children:g("span",{className:"tree-division tree-division1",onClick:()=>H(e.id),children:[b=="ActividadEconomica"&&d("div",{class:"tree-division__img",children:d("img",{src:`/public/images/subcategorias/${e.icon}`,width:"35px"})}),d("span",{className:"tree-division__title my-auto",children:e.nombre})]})})]},e.id),E.includes(e.id)&&d("ul",{className:`tree-children ${b}`,children:A.map((i,a)=>d(S,{children:e.id==i.id_padre_sub_categoria&&g("li",{className:`tree-node has-child draggable segmento ${x.includes(i.id)?"expanded":""}`,id:"segmento_"+i.id,children:[g("div",{className:"tree-content segmento",children:[d("i",{className:"tree-arrow expanded has-child ltr"}),d("input",{id:"segmento_check_"+i.id,class:`${q.includes(i.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>$(i),checked:u.includes(i.id)?"checked":""}),d("span",{className:"tree-anchor",children:b=="ActividadEconomica"?d("span",{className:"tree-division tree-division1",onClick:()=>J(i.id),children:d("span",{className:"tree-division__title my-auto",children:i.nombre})}):d("span",{className:"tree-division tree-division1",children:d(S,{children:a%2==0?d("span",{className:"tree-division__title my-auto",children:i.nombre}):d("span",{className:"tree-division__title-gray my-auto",children:i.nombre})})})})]}),b=="ActividadEconomica"&&x.includes(i.id)&&d("ul",{className:"tree-children actividad-economica",children:w.map((s,c)=>d(S,{children:i.id==s.id_padre_sub_categoria&&d("li",{className:"tree-node draggable",children:g("div",{className:"tree-content actividad-economica",onClick:()=>$(s),children:[d("input",{type:"checkbox",name:"actividad_economica",onChange:()=>$(s),checked:u.includes(s.id)?"checked":""}),d("span",{className:"tree-anchor children",children:d("span",{className:"tree-division tree-division1",children:d(S,{children:d("span",{className:"tree-division__title my-auto",children:s.nombre})})})})]})})}))})]})}))})]})}))})]})};export{ai as A};
