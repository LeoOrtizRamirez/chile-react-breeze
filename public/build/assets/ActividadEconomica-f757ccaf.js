import{r as n,j as g,F as k,a as t}from"./app-1bab00e1.js";const ae=({subcategorias:V,id:D,nameBuscador:H,onHandleSectores:K,tipo:I,checkeds:z})=>{const[l,ee]=n.exports.useState(V),[$,O]=n.exports.useState(V),[E,N]=n.exports.useState([]),[x,S]=n.exports.useState([]),[G,J]=n.exports.useState([]);n.exports.useEffect(()=>{var i=[];l.forEach(e=>{if(e.childs.length>0){var a=[],s=[];e.id_padre_sub_categoria==null&&(e.childs.forEach(d=>{a.push(d.id);var r=l.filter(o=>o.id==d.id)[0];r.childs.length>0&&r.childs.forEach(o=>{s.push(o.id)})}),i[e.id]=["sectores"],i[e.id].segmentos=a,i[e.id].actividades_economicas=s)}}),J(i)},[]);const[u,B]=n.exports.useState(z),[C,L]=n.exports.useState([]),[w,j]=n.exports.useState([]),Q=i=>{var e=document.getElementById("sector_"+i);e.classList.toggle("expanded"),E.includes(i)?N(E.filter(d=>d!=i)):N([...E,i]);const a=new RegExp(i,"i");$.filter(function(d){if(a.test(d.id_padre_sub_categoria))return d}).forEach(d=>{if(!C.includes(d))C.push(d);else{const r=C.filter(o=>o.id_padre_sub_categoria!=i);L(r)}})},U=i=>{var e=document.getElementById("segmento_"+i);e.classList.toggle("expanded"),x.includes(i)?S(x.filter(d=>d!=i)):S([...x,i]);const a=new RegExp(i,"i");$.filter(function(d){if(a.test(d.id_padre_sub_categoria))return d}).forEach(d=>{if(!w.includes(d))w.push(d);else{const r=w.filter(o=>o.id_padre_sub_categoria!=i);j(r)}})},A=i=>{var e=[];u.forEach(d=>{e.push(d)});var a=l.filter(d=>d.id_padre_sub_categoria==i.id&&d.id_abuelo_sub_categoria==null);if(a.length>0)e.includes(i.id)?(e=h(e,i.id),e=m(e,a,"segmento","remove")):(e.push(i.id),e=m(e,a,"segmento","remove"),e=m(e,a,"segmento","add"));else{var s=l.filter(d=>d.id_padre_sub_categoria==i.id);s.length>0?e.includes(i.id)?(e=h(e,i.id),e=m(e,s,"actividad_economica","remove")):(e.push(i.id),e=m(e,s,"actividades_economicas","remove"),e=m(e,s,"actividad_economica","add")):e.includes(i.id)?e=h(e,i.id):e.push(i.id)}e=[...new Set(e)],B(e),W(e,i)},W=(i,e)=>{if(b(e.id,"actividades_economicas")){var a=P(i,"actividades_economicas"),s=T(a,e,"actividades_economicas"),d=s[0],r=s[1],o=!0,p=0,c=R(e.id_padre_sub_categoria,"actividades_economicas");c.forEach(v=>{a.includes(v)?p+=1:o=!1}),o?(i.push(e.id_padre_sub_categoria),_("segmento_check_"+e.id_padre_sub_categoria,"remove")):(i=h(i,e.id_padre_sub_categoria),i=h(i,e.id_abuelo_sub_categoria),B(i),p>0?_("segmento_check_"+e.id_padre_sub_categoria,"add"):_("segmento_check_"+e.id_padre_sub_categoria,"remove"),r>0?_("sector_check_"+e.id_abuelo_sub_categoria,"add"):_("sector_check_"+e.id_abuelo_sub_categoria,"remove")),d&&i.push(e.id_abuelo_sub_categoria)}if(b(e.id,"segmentos")){var F=P(i,"segmentos"),s=T(F,e,"segmentos"),d=s[0],r=s[1];d?i.push(e.id_padre_sub_categoria):(i=h(i,e.id_padre_sub_categoria),B(i),r>0?_("sector_check_"+e.id_padre_sub_categoria,"add"):(_("sector_check_"+e.id_padre_sub_categoria,"remove"),_("segmento_check_"+e.id,"remove")))}if(b(e.id,"sector")){_("sector_check_"+e.id,"remove");var f=R(e.id,"segmentos");f.forEach(v=>{_("segmento_check_"+v,"remove")})}},R=(i,e)=>{var a=[];return l.forEach(s=>{switch(e){case"actividades_economicas":s.id_padre_sub_categoria==i&&a.push(s.id);break;case"segmentos":s.id_padre_sub_categoria==i&&a.push(s.id);break}}),a},P=(i,e)=>{var a=[];return i.forEach(s=>{b(s,e)&&a.push(s)}),a},b=(i,e)=>{var a=l.filter(s=>s.id==i)[0];switch(e){case"actividades_economicas":return a.id_abuelo_sub_categoria!=null&&a.id_padre_sub_categoria!=null?a:!1;case"segmentos":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria!=null?a:!1;case"sector":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria==null?a:!1}},T=(i,e,a)=>{var s=!0,d=0;if(i.length>0){var r=l.filter(p=>p.id==e.id)[0],o=0;switch(a){case"actividades_economicas":o=r.id_abuelo_sub_categoria;break;case"segmentos":o=r.id_padre_sub_categoria;break;case"sector":o=r.id;break}G[o][a].forEach(p=>{i.includes(p)?d+=1:s=!1})}else s=!1;return[s,d]},_=(i,e)=>{var a=document.getElementById(i);e=="add"?a&&a.classList.add("check-minus"):a&&a.classList.remove("check-minus")},h=(i,e)=>{const a=i.indexOf(e);return a>-1&&i.splice(a,1),i},m=(i,e,a=null,s)=>(e.forEach(d=>{switch(s){case"add":i.push(d.id),a=="segmento"&&l.filter(o=>o.id_padre_sub_categoria==d.id).forEach(o=>{i.push(o.id)});break;case"remove":i=h(i,d.id),a=="segmento"&&l.filter(o=>o.id_padre_sub_categoria==d.id).forEach(o=>{i=h(i,o.id)});break}}),i),X=i=>{if(i.target.value==""){O(l),L([]),j([]),N([]),S([]);return}if(i.key==="Enter"){const o=new RegExp(i.target.value,"i"),p=l.filter(function(c){if(o.test(c.nombre)||i.target.value==c.id)return c});var e=[],a=[],s=[],d=[],r=[];p.forEach(c=>{if(c.id_abuelo_sub_categoria!=null&&c.id_padre_sub_categoria!=null){s.push(c);var F=l.filter(v=>v.id==c.id_padre_sub_categoria)[0];a.includes(F)||a.push(F),d.includes(c.id_padre_sub_categoria)||d.push(c.id_padre_sub_categoria);var f=l.filter(v=>v.id==c.id_abuelo_sub_categoria)[0];e.includes(f)||e.push(f),r.includes(c.id_abuelo_sub_categoria)||r.push(c.id_abuelo_sub_categoria)}if(c.id_abuelo_sub_categoria==null&&c.id_padre_sub_categoria!=null){a.includes(c)||a.push(c),d.includes(c.id)||d.push(c.id);var f=l.filter(y=>y.id==c.id_padre_sub_categoria)[0];e.includes(f)||e.push(f),r.includes(c.id_padre_sub_categoria)||r.push(c.id_padre_sub_categoria)}c.id_abuelo_sub_categoria==null&&c.id_padre_sub_categoria==null&&(e.includes(c)||e.push(c),r.includes(c.id)||r.push(c.id))}),O(e),L(a),j(s),N(r),S(d)}};n.exports.useEffect(()=>{K(u,I)},[u]);const[q,Y]=n.exports.useState([]);n.exports.useEffect(()=>{Z()},[u]);const Z=()=>{let i=[];u.forEach(e=>{if(b(e,"actividades_economicas")){var a=M(e);i.push(a.id);var s=M(a.id);i.push(s.id)}if(b(e,"segmentos")){var s=M(e);i.push(s.id)}}),i=[...new Set(i)],Y(i)},M=i=>{var e=l.filter(s=>s.id==i)[0],a=l.filter(s=>s.id==e.id_padre_sub_categoria)[0];return a};return g(k,{children:[g("div",{className:"mx-60 mt-30 d-flex",children:[t("button",{button:!0,type:"button",className:"icon-Buscar-click"}),t("input",{type:"text",placeholder:H,autoComplete:"off",className:"form-control busqueda-input",onKeyDown:X}),g("h2",{className:"perfiles-titulos d-flex",children:[" ","Pais de contrataciÃ³n",t("img",{className:"bandera",src:"/public/images/banderas/listado_nombres/CHL.svg",alt:"Bandera Chile"})]})]}),t("br",{}),t("ul",{className:`tree-root ${I}`,id:D,children:$.map(i=>t(k,{children:i.id_padre_sub_categoria==null&&g("li",{className:`tree-node has-child draggable ${E.includes(i.id)?"expanded":""}`,id:"sector_"+i.id,children:[g("div",{id:i.id,className:"tree-content mt-3 sector",children:[t("i",{className:`tree-arrow has-child ${i.childs.length>0?"bi bi-chevron-down":""}`}),t("input",{id:"sector_check_"+i.id,class:`${q.includes(i.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>A(i),checked:u.includes(i.id)?"checked":""}),t("span",{className:"tree-anchor",children:t("span",{className:"tree-division tree-division1",onClick:()=>Q(i.id),children:t("span",{className:"tree-division__title my-auto",children:i.nombre})})})]},i.id),E.includes(i.id)&&t("ul",{className:`tree-children ${I}`,children:C.map((e,a)=>t(k,{children:i.id==e.id_padre_sub_categoria&&g("li",{className:`tree-node has-child draggable segmento ${x.includes(e.id)?"expanded":""}`,id:"segmento_"+e.id,children:[g("div",{className:"tree-content segmento",children:[t("i",{className:"tree-arrow expanded has-child ltr"}),t("input",{id:"segmento_check_"+e.id,class:`${q.includes(e.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>A(e),checked:u.includes(e.id)?"checked":""}),t("span",{className:"tree-anchor",children:t("span",{className:"tree-division tree-division1",onClick:()=>U(e.id),children:t(k,{children:a%2==0?t("span",{className:"tree-division__title my-auto",children:e.nombre}):t("span",{className:"tree-division__title-gray my-auto",children:e.nombre})})})})]}),x.includes(e.id)&&t("ul",{className:"tree-children actividad-economica",children:w.map((s,d)=>t(k,{children:e.id==s.id_padre_sub_categoria&&t("li",{className:"tree-node draggable",children:g("div",{className:"tree-content actividad-economica",onClick:()=>A(s),children:[t("input",{type:"checkbox",name:"actividad_economica",onChange:()=>A(s),checked:u.includes(s.id)?"checked":""}),t("span",{className:"tree-anchor children",children:t("span",{className:"tree-division tree-division1",children:t(k,{children:t("span",{className:"tree-division__title my-auto",children:s.nombre})})})})]})})}))})]})}))})]})}))})]})};export{ae as A};
