import{r,j as h,a as d,F as A}from"./app-92efdb12.js";const ci=({subcategorias:B,id:P,nameBuscador:T,onHandleSectores:y,tipo:p,checkeds:G,checkAllText:O})=>{console.log("subcategorias",B);const[n,ai]=r.exports.useState(B),[b,R]=r.exports.useState(B),[x,w]=r.exports.useState([]),[S,$]=r.exports.useState([]),[H,J]=r.exports.useState([]);r.exports.useEffect(()=>{var i=[];n.forEach(e=>{if(e.childs.length>0){var a=[],s=[];e.id_padre_sub_categoria==null&&(e.childs.forEach(c=>{a.push(c.id);var l=n.filter(t=>t.id==c.id)[0];l.childs.length>0&&l.childs.forEach(t=>{s.push(t.id)})}),i[e.id]=["sectores"],i[e.id].segmentos=a,i[e.id].actividades_economicas=s)}}),J(i),console.log("full_array",i)},[]);const[_,N]=r.exports.useState(G),[F,L]=r.exports.useState([]),[I,M]=r.exports.useState([]),Q=i=>{var e=document.getElementById("sector_"+i);e.classList.toggle("expanded"),x.includes(i)?w(x.filter(c=>c!=i)):w([...x,i]);const a=new RegExp(i,"i");b.filter(function(c){if(a.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!F.includes(c))F.push(c);else{const l=F.filter(t=>t.id_padre_sub_categoria!=i);L(l)}})},U=i=>{var e=document.getElementById("segmento_"+i);e.classList.toggle("expanded"),S.includes(i)?$(S.filter(c=>c!=i)):$([...S,i]);const a=new RegExp(i,"i");b.filter(function(c){if(a.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!I.includes(c))I.push(c);else{const l=I.filter(t=>t.id_padre_sub_categoria!=i);M(l)}})},W=()=>{if(_.length<b.length){var i=b.map(e=>e.id);i=[...new Set(i)],N(i)}else N([])},C=i=>{var e=[];_.forEach(c=>{e.push(c)});var a=n.filter(c=>c.id_padre_sub_categoria==i.id&&c.id_abuelo_sub_categoria==null);if(a.length>0)e.includes(i.id)?(e=g(e,i.id),e=E(e,a,"segmento","remove")):(e.push(i.id),e=E(e,a,"segmento","remove"),e=E(e,a,"segmento","add"));else{var s=n.filter(c=>c.id_padre_sub_categoria==i.id);s.length>0?e.includes(i.id)?(e=g(e,i.id),e=E(e,s,"actividad_economica","remove")):(e.push(i.id),e=E(e,s,"actividades_economicas","remove"),e=E(e,s,"actividad_economica","add")):e.includes(i.id)?e=g(e,i.id):e.push(i.id)}e=[...new Set(e)],N(e),X(e,i)},X=(i,e)=>{if(k(e.id,"actividades_economicas")){var a=z(i,"actividades_economicas"),s=D(a,e,"actividades_economicas"),c=s[0],l=s[1],t=!0,v=0,o=q(e.id_padre_sub_categoria,"actividades_economicas");o.forEach(m=>{a.includes(m)?v+=1:t=!1}),t?(i.push(e.id_padre_sub_categoria),u("segmento_check_"+e.id_padre_sub_categoria,"remove")):(i=g(i,e.id_padre_sub_categoria),i=g(i,e.id_abuelo_sub_categoria),N(i),v>0?u("segmento_check_"+e.id_padre_sub_categoria,"add"):u("segmento_check_"+e.id_padre_sub_categoria,"remove"),l>0?u("sector_check_"+e.id_abuelo_sub_categoria,"add"):u("sector_check_"+e.id_abuelo_sub_categoria,"remove")),c&&i.push(e.id_abuelo_sub_categoria)}if(k(e.id,"segmentos")){var j=z(i,"segmentos"),s=D(j,e,"segmentos"),c=s[0],l=s[1];c?i.push(e.id_padre_sub_categoria):(i=g(i,e.id_padre_sub_categoria),N(i),l>0?u("sector_check_"+e.id_padre_sub_categoria,"add"):(u("sector_check_"+e.id_padre_sub_categoria,"remove"),u("segmento_check_"+e.id,"remove")))}if(k(e.id,"sector")){u("sector_check_"+e.id,"remove");var f=q(e.id,"segmentos");f.forEach(m=>{u("segmento_check_"+m,"remove")})}},q=(i,e)=>{var a=[];return n.forEach(s=>{switch(e){case"actividades_economicas":s.id_padre_sub_categoria==i&&a.push(s.id);break;case"segmentos":s.id_padre_sub_categoria==i&&a.push(s.id);break}}),a},z=(i,e)=>{var a=[];return i.forEach(s=>{k(s,e)&&a.push(s)}),a},k=(i,e)=>{var a=n.filter(s=>s.id==i)[0];switch(e){case"actividades_economicas":return a.id_abuelo_sub_categoria!=null&&a.id_padre_sub_categoria!=null?a:!1;case"segmentos":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria!=null?a:!1;case"sector":return a.id_abuelo_sub_categoria==null&&a.id_padre_sub_categoria==null?a:!1}},D=(i,e,a)=>{var s=!0,c=0;if(i.length>0){var l=n.filter(v=>v.id==e.id)[0],t=0;switch(a){case"actividades_economicas":t=l.id_abuelo_sub_categoria;break;case"segmentos":t=l.id_padre_sub_categoria;break;case"sector":t=l.id;break}H[t][a].forEach(v=>{i.includes(v)?c+=1:s=!1})}else s=!1;return[s,c]},u=(i,e)=>{var a=document.getElementById(i);e=="add"?a&&a.classList.add("check-minus"):a&&a.classList.remove("check-minus")},g=(i,e)=>{const a=i.indexOf(e);return a>-1&&i.splice(a,1),i},E=(i,e,a=null,s)=>(e.forEach(c=>{switch(s){case"add":i.push(c.id),a=="segmento"&&n.filter(t=>t.id_padre_sub_categoria==c.id).forEach(t=>{i.push(t.id)});break;case"remove":i=g(i,c.id),a=="segmento"&&n.filter(t=>t.id_padre_sub_categoria==c.id).forEach(t=>{i=g(i,t.id)});break}}),i),Y=i=>{if(i.target.value==""){R(n),L([]),M([]),w([]),$([]);return}if(i.key==="Enter"){const t=new RegExp(i.target.value,"i"),v=n.filter(function(o){if(t.test(o.nombre)||i.target.value==o.id)return o});var e=[],a=[],s=[],c=[],l=[];v.forEach(o=>{if(o.id_abuelo_sub_categoria!=null&&o.id_padre_sub_categoria!=null){s.push(o);var j=n.filter(m=>m.id==o.id_padre_sub_categoria)[0];a.includes(j)||a.push(j),c.includes(o.id_padre_sub_categoria)||c.push(o.id_padre_sub_categoria);var f=n.filter(m=>m.id==o.id_abuelo_sub_categoria)[0];e.includes(f)||e.push(f),l.includes(o.id_abuelo_sub_categoria)||l.push(o.id_abuelo_sub_categoria)}if(o.id_abuelo_sub_categoria==null&&o.id_padre_sub_categoria!=null){a.includes(o)||a.push(o),c.includes(o.id)||c.push(o.id);var f=n.filter(ei=>ei.id==o.id_padre_sub_categoria)[0];e.includes(f)||e.push(f),l.includes(o.id_padre_sub_categoria)||l.push(o.id_padre_sub_categoria)}o.id_abuelo_sub_categoria==null&&o.id_padre_sub_categoria==null&&(e.includes(o)||e.push(o),l.includes(o.id)||l.push(o.id))}),R(e),L(a),M(s),w(l),$(c)}};r.exports.useEffect(()=>{y(_,p)},[_]);const[K,Z]=r.exports.useState([]);r.exports.useEffect(()=>{ii()},[_]);const ii=()=>{let i=[];_.forEach(e=>{if(k(e,"actividades_economicas")){var a=V(e);i.push(a.id);var s=V(a.id);i.push(s.id)}if(k(e,"segmentos")){var s=V(e);i.push(s.id)}}),i=[...new Set(i)],Z(i)},V=i=>{var e=n.filter(s=>s.id==i)[0],a=n.filter(s=>s.id==e.id_padre_sub_categoria)[0];return a};return h("div",{id:"SubCategorias",children:[d("div",{class:"tree_categorias__busqueda mb-3 mb-md-4",children:h("div",{class:"mx-auto",children:[d("input",{type:"text",placeholder:T,class:"form-control",onKeyDown:Y}),d("i",{class:"icon-Cancelar",style:{display:"none"}}),d("button",{type:"button",class:"icon-Buscar-click"})]})}),O!=""&&h("div",{class:"tree_categorias__check_personalizado",children:[d("input",{type:"checkbox",name:"check_all2",id:"check_all2",class:"form-check-input filled-in",onChange:W,checked:_.length==b.length}),d("label",{for:"check_all2",children:O})]}),d("ul",{className:`tree-root ${p}`,id:P,children:b.map(i=>d(A,{children:i.id_padre_sub_categoria==null&&h("li",{className:`tree-node has-child draggable ${x.includes(i.id)?"expanded":""}`,id:"sector_"+i.id,children:[h("div",{id:i.id,className:"tree-content sector",children:[d("i",{className:`${i.childs.length>0?"tree-arrow has-child ltr":""}`}),d("input",{id:"sector_check_"+i.id,class:`${K.includes(i.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>C(i),checked:_.includes(i.id)?"checked":""}),d("span",{className:"tree-anchor",children:i.childs.length>0?h("span",{className:"tree-division tree-division1",onClick:()=>Q(i.id),children:[p=="ActividadEconomica"&&d("div",{class:"tree-division__img",children:d("img",{src:`/public/images/subcategorias/${i.icon}`,width:"35px"})}),d("span",{className:"tree-division__title my-auto",children:i.nombre})]}):h("span",{className:"tree-division tree-division1",onClick:()=>C(i),children:[p=="ActividadEconomica"&&d("div",{class:"tree-division__img",children:d("img",{src:`/public/images/subcategorias/${i.icon}`,width:"35px"})}),d("span",{className:"tree-division__title my-auto",children:i.nombre})]})})]},i.id),x.includes(i.id)&&d("ul",{className:`tree-children ${p}`,children:F.map((e,a)=>d(A,{children:i.id==e.id_padre_sub_categoria&&h("li",{className:`tree-node has-child draggable segmento ${S.includes(e.id)?"expanded":""}`,id:"segmento_"+e.id,children:[h("div",{className:"tree-content segmento",children:[d("i",{className:"tree-arrow expanded has-child ltr"}),d("input",{id:"segmento_check_"+e.id,class:`${K.includes(e.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>C(e),checked:_.includes(e.id)?"checked":""}),d("span",{className:"tree-anchor",children:p=="ActividadEconomica"?d("span",{className:"tree-division tree-division1",onClick:()=>U(e.id),children:d("span",{className:"tree-division__title my-auto",children:e.nombre})}):d("span",{className:"tree-division tree-division1",children:d(A,{children:a%2==0?d("span",{className:"tree-division__title my-auto",children:e.nombre}):d("span",{className:"tree-division__title-gray my-auto",children:e.nombre})})})})]}),p=="ActividadEconomica"&&S.includes(e.id)&&d("ul",{className:"tree-children actividad-economica",children:I.map((s,c)=>d(A,{children:e.id==s.id_padre_sub_categoria&&d("li",{className:"tree-node draggable",children:h("div",{className:"tree-content actividad-economica",onClick:()=>C(s),children:[d("input",{type:"checkbox",name:"actividad_economica",onChange:()=>C(s),checked:_.includes(s.id)?"checked":""}),d("span",{className:"tree-anchor children",children:d("span",{className:"tree-division tree-division1",children:d(A,{children:d("span",{className:"tree-division__title my-auto",children:s.nombre})})})})]})})}))})]})}))})]})}))})]})};export{ci as A};
