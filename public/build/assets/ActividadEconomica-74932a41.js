import{r as u,j as f,a as t,F as A}from"./app-fc2cb093.js";const re=({subcategorias:q,id:J,nameBuscador:Q,onHandleSectores:U,tipo:p,checkeds:W,checkAllText:L,licicodigos:z})=>{const[r,oe]=u.exports.useState(q),[m,D]=u.exports.useState(q),[x,$]=u.exports.useState([]),[N,I]=u.exports.useState([]),[X,Y]=u.exports.useState([]),[Z,S]=u.exports.useState(!1);u.exports.useEffect(()=>{var e=[];r.forEach(i=>{if(i.childs.length>0){var s=[],a=[];i.id_padre_sub_categoria==null&&(i.childs.forEach(c=>{s.push(c.id);var n=r.filter(o=>o.id==c.id)[0];n.childs.length>0&&n.childs.forEach(o=>{a.push(o.id)})}),e[i.id]=["sectores"],e[i.id].segmentos=s,e[i.id].actividades_economicas=a)}}),Y(e)},[]);const[_,C]=u.exports.useState(W),[B,j]=u.exports.useState([]),[O,M]=u.exports.useState([]),F=e=>{var i=document.getElementById("sector_"+e);i.classList.toggle("expanded"),x.includes(e)?$(x.filter(c=>c!=e)):$([...x,e]);const s=new RegExp(e,"i");m.filter(function(c){if(s.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!B.includes(c))B.push(c);else{const n=B.filter(o=>o.id_padre_sub_categoria!=e);j(n)}})},ee=e=>{var i=document.getElementById("segmento_"+e);i.classList.toggle("expanded"),N.includes(e)?I(N.filter(c=>c!=e)):I([...N,e]);const s=new RegExp(e,"i");m.filter(function(c){if(s.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!O.includes(c))O.push(c);else{const n=O.filter(o=>o.id_padre_sub_categoria!=e);M(n)}})},ie=()=>{if(_.length<m.length){var e=m.map(i=>i.id);e=[...new Set(e)],C(e)}else C([])},w=e=>{var i=[];_.forEach(c=>{i.push(c)});var s=r.filter(c=>c.id_padre_sub_categoria==e.id&&c.id_abuelo_sub_categoria==null);if(s.length>0)i.includes(e.id)?(i=v(i,e.id),i=E(i,s,"segmento","remove")):(i.push(e.id),i=E(i,s,"segmento","remove"),i=E(i,s,"segmento","add"));else{var a=r.filter(c=>c.id_padre_sub_categoria==e.id);a.length>0?i.includes(e.id)?(i=v(i,e.id),i=E(i,a,"actividad_economica","remove")):(i.push(e.id),i=E(i,a,"actividades_economicas","remove"),i=E(i,a,"actividad_economica","add")):i.includes(e.id)?i=v(i,e.id):i.push(e.id)}i=[...new Set(i)],C(i),ae(i,e)},ae=(e,i)=>{if(k(i.id,"actividades_economicas")){var s=P(e,"actividades_economicas"),a=T(s,i,"actividades_economicas"),c=a[0],n=a[1],o=!0,l=0,y=K(i.id_padre_sub_categoria,"actividades_economicas");y.forEach(g=>{s.includes(g)?l+=1:o=!1}),o?(e.push(i.id_padre_sub_categoria),h("segmento_check_"+i.id_padre_sub_categoria,"remove")):(e=v(e,i.id_padre_sub_categoria),e=v(e,i.id_abuelo_sub_categoria),C(e),l>0?h("segmento_check_"+i.id_padre_sub_categoria,"add"):h("segmento_check_"+i.id_padre_sub_categoria,"remove"),n>0?h("sector_check_"+i.id_abuelo_sub_categoria,"add"):h("sector_check_"+i.id_abuelo_sub_categoria,"remove")),c&&e.push(i.id_abuelo_sub_categoria)}if(k(i.id,"segmentos")){var d=P(e,"segmentos"),a=T(d,i,"segmentos"),c=a[0],n=a[1];c?e.push(i.id_padre_sub_categoria):(e=v(e,i.id_padre_sub_categoria),C(e),n>0?h("sector_check_"+i.id_padre_sub_categoria,"add"):(h("sector_check_"+i.id_padre_sub_categoria,"remove"),h("segmento_check_"+i.id,"remove")))}if(k(i.id,"sector")){h("sector_check_"+i.id,"remove");var b=K(i.id,"segmentos");b.forEach(g=>{h("segmento_check_"+g,"remove")})}},K=(e,i)=>{var s=[];return r.forEach(a=>{switch(i){case"actividades_economicas":a.id_padre_sub_categoria==e&&s.push(a.id);break;case"segmentos":a.id_padre_sub_categoria==e&&s.push(a.id);break}}),s},P=(e,i)=>{var s=[];return e.forEach(a=>{k(a,i)&&s.push(a)}),s},k=(e,i)=>{var s=r.filter(a=>a.id==e)[0];switch(i){case"actividades_economicas":return s.id_abuelo_sub_categoria!=null&&s.id_padre_sub_categoria!=null?s:!1;case"segmentos":return s.id_abuelo_sub_categoria==null&&s.id_padre_sub_categoria!=null?s:!1;case"sector":return s.id_abuelo_sub_categoria==null&&s.id_padre_sub_categoria==null?s:!1}},T=(e,i,s)=>{var a=!0,c=0;if(e.length>0){var n=r.filter(l=>l.id==i.id)[0],o=0;switch(s){case"actividades_economicas":o=n.id_abuelo_sub_categoria;break;case"segmentos":o=n.id_padre_sub_categoria;break;case"sector":o=n.id;break}X[o][s].forEach(l=>{e.includes(l)?c+=1:a=!1})}else a=!1;return[a,c]},h=(e,i)=>{var s=document.getElementById(e);i=="add"?s&&s.classList.add("check-minus"):s&&s.classList.remove("check-minus")},v=(e,i)=>{const s=e.indexOf(i);return s>-1&&e.splice(s,1),e},E=(e,i,s=null,a)=>(i.forEach(c=>{switch(a){case"add":e.push(c.id),s=="segmento"&&r.filter(o=>o.id_padre_sub_categoria==c.id).forEach(o=>{e.push(o.id)});break;case"remove":e=v(e,c.id),s=="segmento"&&r.filter(o=>o.id_padre_sub_categoria==c.id).forEach(o=>{e=v(e,o.id)});break}}),e),G=e=>{var i=e[0].filtros.split(",").filter(a=>a!=="");i=i.map(a=>parseInt(a));var s=[];return s=r.filter(function(a){if(i.includes(a.id))return a}),s.sort((a,c)=>{const n=i.indexOf(a.id),o=i.indexOf(c.id);return n===-1?1:o===-1?-1:n-o}),s},se=e=>{if(S(!1),e.target.value==""){D(r),j([]),M([]),$([]),I([]),S(!1);return}if(e.key==="Enter"){const y=new RegExp(e.target.value,"i");var i=[],s=[];if(!isNaN(e.target.value)&&e.target.value.length>=6){if(i=z.filter(function(d){if(e.target.value==(d==null?void 0:d.id))return d}),i.length==0){S(!0);return}s=G(i)}else if(!isNaN(e.target.value)&&e.target.value.length<6)S(!0);else if(i=z.filter(function(d){var b;if(e.target.value.toLowerCase()==((b=d==null?void 0:d.nombre)==null?void 0:b.toLowerCase()))return d}),i.length==0)s=r.filter(function(d){if(y.test(d.nombre))return d}),s.length==0&&S(!0);else{if(i.length==0)return;s=G(i)}var a=[],c=[],n=[],o=[],l=[];s.forEach(d=>{if(d.id_abuelo_sub_categoria!=null&&d.id_padre_sub_categoria!=null){n.push(d);var b=r.filter(R=>R.id==d.id_padre_sub_categoria)[0];c.includes(b)||c.push(b),o.includes(d.id_padre_sub_categoria)||o.push(d.id_padre_sub_categoria);var g=r.filter(R=>R.id==d.id_abuelo_sub_categoria)[0];a.includes(g)||a.push(g),l.includes(d.id_abuelo_sub_categoria)||l.push(d.id_abuelo_sub_categoria)}if(d.id_abuelo_sub_categoria==null&&d.id_padre_sub_categoria!=null){c.includes(d)||c.push(d),o.includes(d.id)||o.push(d.id);var g=r.filter(te=>te.id==d.id_padre_sub_categoria)[0];a.includes(g)||a.push(g),l.includes(d.id_padre_sub_categoria)||l.push(d.id_padre_sub_categoria)}d.id_abuelo_sub_categoria==null&&d.id_padre_sub_categoria==null&&(a.includes(d)||a.push(d),l.includes(d.id)||l.push(d.id))}),D(a),j(c),M(n),$(l),I(o)}};u.exports.useEffect(()=>{U(_,p)},[_]);const[H,ce]=u.exports.useState([]);u.exports.useEffect(()=>{de()},[_]);const de=()=>{let e=[];_.forEach(i=>{if(k(i,"actividades_economicas")){var s=V(i);e.push(s.id);var a=V(s.id);e.push(a.id)}if(k(i,"segmentos")){var a=V(i);e.push(a.id)}}),e=[...new Set(e)],ce(e)},V=e=>{var i=r.filter(a=>a.id==e)[0],s=r.filter(a=>a.id==i.id_padre_sub_categoria)[0];return s};return f("div",{id:"SubCategorias",children:[t("div",{class:"tree_categorias__busqueda mb-3 mb-md-4",children:f("div",{class:"mx-auto",children:[t("input",{type:"text",placeholder:Q,class:"form-control",onKeyDown:se}),t("i",{class:"icon-Cancelar",style:{display:"none"}}),t("button",{type:"button",class:"icon-Buscar-click"})]})}),L!=""&&f("div",{class:"tree_categorias__check_personalizado",children:[t("input",{type:"checkbox",name:"check_all2",id:"check_all2",class:"form-check-input filled-in",onChange:ie,checked:_.length==m.length}),t("label",{for:"check_all2",children:L})]}),Z?t("div",{class:"tree-filter-empty",children:"No hay resultados con esta bÃºsqueda"}):t("ul",{className:`tree-root ${p}`,id:J,children:m.map(e=>t(A,{children:e.id_padre_sub_categoria==null&&f("li",{className:`tree-node has-child draggable ${x.includes(e.id)?"expanded":""}`,id:"sector_"+e.id,children:[f("div",{id:e.id,className:"tree-content sector",children:[t("i",{className:`${e.childs.length>0?"tree-arrow has-child ltr":""}`}),t("input",{id:"sector_check_"+e.id,class:`${H.includes(e.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>w(e),checked:_.includes(e.id)?"checked":""}),t("span",{className:"tree-anchor",children:e.childs.length>0?f("span",{className:"tree-division tree-division1",onClick:()=>F(e.id),children:[p=="ActividadEconomica"&&t("div",{class:"tree-division__img",children:t("img",{src:`/public/images/subcategorias/${e.icon}`,width:"35px"})}),t("span",{className:"tree-division__title my-auto",children:e.nombre})]}):f("span",{className:"tree-division tree-division1",onClick:()=>w(e),children:[p=="ActividadEconomica"&&t("div",{class:"tree-division__img",children:t("img",{src:`/public/images/subcategorias/${e.icon}`,width:"35px"})}),t("span",{className:"tree-division__title my-auto",children:e.nombre})]})})]},e.id),x.includes(e.id)&&t("ul",{className:`tree-children ${p}`,children:B.map((i,s)=>t(A,{children:e.id==i.id_padre_sub_categoria&&f("li",{className:`tree-node has-child draggable segmento ${N.includes(i.id)?"expanded":""}`,id:"segmento_"+i.id,children:[f("div",{className:"tree-content segmento",children:[t("i",{className:"tree-arrow expanded has-child ltr"}),t("input",{id:"segmento_check_"+i.id,class:`${H.includes(i.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>w(i),checked:_.includes(i.id)?"checked":""}),t("span",{className:"tree-anchor",children:p=="ActividadEconomica"?t("span",{className:"tree-division tree-division1",onClick:()=>ee(i.id),children:t("span",{className:"tree-division__title my-auto",children:i.nombre})}):t("span",{className:"tree-division tree-division1",children:t(A,{children:s%2==0?t("span",{className:"tree-division__title my-auto",children:i.nombre}):t("span",{className:"tree-division__title-gray my-auto",children:i.nombre})})})})]}),p=="ActividadEconomica"&&N.includes(i.id)&&t("ul",{className:"tree-children actividad-economica",children:O.map((a,c)=>t(A,{children:i.id==a.id_padre_sub_categoria&&t("li",{className:"tree-node draggable",children:f("div",{className:"tree-content actividad-economica",onClick:()=>w(a),children:[t("input",{type:"checkbox",name:"actividad_economica",onChange:()=>w(a),checked:_.includes(a.id)?"checked":""}),t("span",{className:"tree-anchor children",children:t("span",{className:"tree-division tree-division1",children:t(A,{children:t("span",{className:"tree-division__title my-auto",children:a.id+" - "+a.nombre})})})})]})})}))})]})}))})]})}))})]})};export{re as A};
