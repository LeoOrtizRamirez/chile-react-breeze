import{r as u,j as f,a as t,F as O}from"./app-f6b4abf8.js";const re=({subcategorias:L,id:J,nameBuscador:Q,onHandleSectores:U,tipo:p,checkeds:W,checkAllText:y,licicodigos:z})=>{const[r,oe]=u.exports.useState(L),[b,D]=u.exports.useState(L),[N,A]=u.exports.useState([]),[x,$]=u.exports.useState([]),[X,Y]=u.exports.useState([]),[Z,S]=u.exports.useState(!1);u.exports.useEffect(()=>{var i=[];r.forEach(e=>{if(e.childs.length>0){var s=[],a=[];e.id_padre_sub_categoria==null&&(e.childs.forEach(c=>{s.push(c.id);var n=r.filter(o=>o.id==c.id)[0];n.childs.length>0&&n.childs.forEach(o=>{a.push(o.id)})}),i[e.id]=["sectores"],i[e.id].segmentos=s,i[e.id].actividades_economicas=a)}}),Y(i)},[]);const[_,C]=u.exports.useState(W),[I,j]=u.exports.useState([]),[B,M]=u.exports.useState([]),F=i=>{var e=document.getElementById("sector_"+i);e.classList.toggle("expanded"),N.includes(i)?A(N.filter(c=>c!=i)):A([...N,i]);const s=new RegExp(i,"i");b.filter(function(c){if(s.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!I.includes(c))I.push(c);else{const n=I.filter(o=>o.id_padre_sub_categoria!=i);j(n)}})},ee=i=>{var e=document.getElementById("segmento_"+i);e.classList.toggle("expanded"),x.includes(i)?$(x.filter(c=>c!=i)):$([...x,i]);const s=new RegExp(i,"i");b.filter(function(c){if(s.test(c.id_padre_sub_categoria))return c}).forEach(c=>{if(!B.includes(c))B.push(c);else{const n=B.filter(o=>o.id_padre_sub_categoria!=i);M(n)}})},ie=()=>{if(_.length<b.length){var i=b.map(e=>e.id);i=[...new Set(i)],C(i)}else C([])},w=i=>{var e=[];_.forEach(c=>{e.push(c)});var s=r.filter(c=>c.id_padre_sub_categoria==i.id&&c.id_abuelo_sub_categoria==null);if(s.length>0)e.includes(i.id)?(e=v(e,i.id),e=E(e,s,"segmento","remove")):(e.push(i.id),e=E(e,s,"segmento","remove"),e=E(e,s,"segmento","add"));else{var a=r.filter(c=>c.id_padre_sub_categoria==i.id);a.length>0?e.includes(i.id)?(e=v(e,i.id),e=E(e,a,"actividad_economica","remove")):(e.push(i.id),e=E(e,a,"actividades_economicas","remove"),e=E(e,a,"actividad_economica","add")):e.includes(i.id)?e=v(e,i.id):e.push(i.id)}e=[...new Set(e)],C(e),ae(e,i)},ae=(i,e)=>{if(k(e.id,"actividades_economicas")){var s=P(i,"actividades_economicas"),a=T(s,e,"actividades_economicas"),c=a[0],n=a[1],o=!0,l=0,R=K(e.id_padre_sub_categoria,"actividades_economicas");R.forEach(g=>{s.includes(g)?l+=1:o=!1}),o?(i.push(e.id_padre_sub_categoria),h("segmento_check_"+e.id_padre_sub_categoria,"remove")):(i=v(i,e.id_padre_sub_categoria),i=v(i,e.id_abuelo_sub_categoria),C(i),l>0?h("segmento_check_"+e.id_padre_sub_categoria,"add"):h("segmento_check_"+e.id_padre_sub_categoria,"remove"),n>0?h("sector_check_"+e.id_abuelo_sub_categoria,"add"):h("sector_check_"+e.id_abuelo_sub_categoria,"remove")),c&&i.push(e.id_abuelo_sub_categoria)}if(k(e.id,"segmentos")){var d=P(i,"segmentos"),a=T(d,e,"segmentos"),c=a[0],n=a[1];c?i.push(e.id_padre_sub_categoria):(i=v(i,e.id_padre_sub_categoria),C(i),n>0?h("sector_check_"+e.id_padre_sub_categoria,"add"):(h("sector_check_"+e.id_padre_sub_categoria,"remove"),h("segmento_check_"+e.id,"remove")))}if(k(e.id,"sector")){h("sector_check_"+e.id,"remove");var m=K(e.id,"segmentos");m.forEach(g=>{h("segmento_check_"+g,"remove")})}},K=(i,e)=>{var s=[];return r.forEach(a=>{switch(e){case"actividades_economicas":a.id_padre_sub_categoria==i&&s.push(a.id);break;case"segmentos":a.id_padre_sub_categoria==i&&s.push(a.id);break}}),s},P=(i,e)=>{var s=[];return i.forEach(a=>{k(a,e)&&s.push(a)}),s},k=(i,e)=>{var s=r.filter(a=>a.id==i)[0];switch(e){case"actividades_economicas":return s.id_abuelo_sub_categoria!=null&&s.id_padre_sub_categoria!=null?s:!1;case"segmentos":return s.id_abuelo_sub_categoria==null&&s.id_padre_sub_categoria!=null?s:!1;case"sector":return s.id_abuelo_sub_categoria==null&&s.id_padre_sub_categoria==null?s:!1}},T=(i,e,s)=>{var a=!0,c=0;if(i.length>0){var n=r.filter(l=>l.id==e.id)[0],o=0;switch(s){case"actividades_economicas":o=n.id_abuelo_sub_categoria;break;case"segmentos":o=n.id_padre_sub_categoria;break;case"sector":o=n.id;break}X[o][s].forEach(l=>{i.includes(l)?c+=1:a=!1})}else a=!1;return[a,c]},h=(i,e)=>{var s=document.getElementById(i);e=="add"?s&&s.classList.add("check-minus"):s&&s.classList.remove("check-minus")},v=(i,e)=>{const s=i.indexOf(e);return s>-1&&i.splice(s,1),i},E=(i,e,s=null,a)=>(e.forEach(c=>{switch(a){case"add":i.push(c.id),s=="segmento"&&r.filter(o=>o.id_padre_sub_categoria==c.id).forEach(o=>{i.push(o.id)});break;case"remove":i=v(i,c.id),s=="segmento"&&r.filter(o=>o.id_padre_sub_categoria==c.id).forEach(o=>{i=v(i,o.id)});break}}),i),G=i=>{var e=i[0].filtros.split(",").filter(a=>a!=="");e=e.map(a=>parseInt(a));var s=[];return s=r.filter(function(a){if(e.includes(a.id))return a}),s.sort((a,c)=>{const n=e.indexOf(a.id),o=e.indexOf(c.id);return n===-1?1:o===-1?-1:n-o}),s},se=i=>{if(S(!1),i.target.value==""){D(r),j([]),M([]),A([]),$([]),S(!1);return}if(i.key==="Enter"){const R=new RegExp(i.target.value,"i");var e=[],s=[];if(!isNaN(i.target.value)&&i.target.value.length>=6){if(e=z.filter(function(d){if(i.target.value==(d==null?void 0:d.id))return d}),e.length==0){S(!0);return}s=G(e)}else if(!isNaN(i.target.value)&&i.target.value.length<6)S(!0);else if(e=z.filter(function(d){var m;if(i.target.value.toLowerCase()==((m=d==null?void 0:d.nombre)==null?void 0:m.toLowerCase()))return d}),e.length==0)s=r.filter(function(d){if(R.test(d.nombre))return d}),s.length==0&&S(!0);else{if(e.length==0)return;s=G(e)}var a=[],c=[],n=[],o=[],l=[];s.forEach(d=>{if(d.id_abuelo_sub_categoria!=null&&d.id_padre_sub_categoria!=null){n.push(d);var m=r.filter(q=>q.id==d.id_padre_sub_categoria)[0];c.includes(m)||c.push(m),o.includes(d.id_padre_sub_categoria)||o.push(d.id_padre_sub_categoria);var g=r.filter(q=>q.id==d.id_abuelo_sub_categoria)[0];a.includes(g)||a.push(g),l.includes(d.id_abuelo_sub_categoria)||l.push(d.id_abuelo_sub_categoria)}if(d.id_abuelo_sub_categoria==null&&d.id_padre_sub_categoria!=null){c.includes(d)||c.push(d),o.includes(d.id)||o.push(d.id);var g=r.filter(te=>te.id==d.id_padre_sub_categoria)[0];a.includes(g)||a.push(g),l.includes(d.id_padre_sub_categoria)||l.push(d.id_padre_sub_categoria)}d.id_abuelo_sub_categoria==null&&d.id_padre_sub_categoria==null&&(a.includes(d)||a.push(d),l.includes(d.id)||l.push(d.id))}),D(a),j(c),M(n),A(l),$(o)}};u.exports.useEffect(()=>{U(_,p)},[_]);const[H,ce]=u.exports.useState([]);u.exports.useEffect(()=>{de()},[_]);const de=()=>{let i=[];_.forEach(e=>{if(k(e,"actividades_economicas")){var s=V(e);i.push(s.id);var a=V(s.id);i.push(a.id)}if(k(e,"segmentos")){var a=V(e);i.push(a.id)}}),i=[...new Set(i)],ce(i)},V=i=>{var e=r.filter(a=>a.id==i)[0],s=r.filter(a=>a.id==e.id_padre_sub_categoria)[0];return s};return f("div",{id:"SubCategorias",children:[t("div",{className:"tree_categorias__busqueda mb-3 mb-md-4",children:f("div",{className:"mx-auto",children:[t("input",{type:"text",placeholder:Q,className:"form-control",onKeyDown:se}),t("i",{className:"icon-Cancelar",style:{display:"none"}}),t("button",{type:"button",className:"icon-Buscar-click"})]})}),y!=""&&f("div",{className:"tree_categorias__check_personalizado",children:[t("input",{type:"checkbox",name:"check_all2",id:"check_all2",className:"form-check-input filled-in",onChange:ie,checked:_.length==b.length}),t("label",{for:"check_all2",children:y})]}),Z?t("div",{className:"tree-filter-empty",children:"No hay resultados con esta bÃºsqueda"}):t("ul",{className:`tree-root ${p}`,id:J,children:b.map(i=>t(O,{children:i.id_padre_sub_categoria==null&&f("li",{className:`tree-node has-child draggable ${N.includes(i.id)?"expanded":""}`,id:"sector_"+i.id,children:[f("div",{id:i.id,className:"tree-content sector",children:[t("i",{className:`${i.childs.length>0?"tree-arrow has-child ltr":""}`}),t("input",{id:"sector_check_"+i.id,class:`${H.includes(i.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>w(i),checked:_.includes(i.id)?"checked":""}),t("span",{className:"tree-anchor",children:i.childs.length>0?f("span",{className:"tree-division tree-division1",onClick:()=>F(i.id),children:[p=="ActividadEconomica"&&t("div",{className:"tree-division__img",children:t("img",{src:`/public/images/subcategorias/${i.icon}`,width:"35px"})}),t("span",{className:"tree-division__title my-auto",children:i.nombre})]}):f("span",{className:"tree-division tree-division1",onClick:()=>w(i),children:[p=="ActividadEconomica"&&t("div",{className:"tree-division__img",children:t("img",{src:`/public/images/subcategorias/${i.icon}`,width:"35px"})}),t("span",{className:"tree-division__title my-auto",children:i.nombre})]})})]},i.id),N.includes(i.id)&&t("ul",{className:`tree-children ${p}`,children:I.map((e,s)=>t(O,{children:i.id==e.id_padre_sub_categoria&&f("li",{className:`${e.childs.length>0?`tree-node has-child draggable segmento ${x.includes(e.id)?"expanded":""}`:"tree-node draggable"} `,id:"segmento_"+e.id,children:[f("div",{className:`${e.childs.length>0?"tree-content segmento":"tree-content actividad-economica"}`,children:[t("i",{className:`${e.childs.length>0?"tree-arrow has-child ltr":""}`}),t("input",{id:"segmento_check_"+e.id,class:`${H.includes(e.id)?"check-minus":""}`,type:"checkbox",name:"actividad_economica",onChange:()=>w(e),checked:_.includes(e.id)?"checked":""}),t("span",{className:`${e.childs.length>0?"tree-anchor":"tree-anchor children"}`,children:p=="ActividadEconomica"?t("span",{className:"tree-division tree-division1",onClick:()=>ee(e.id),children:t("span",{className:"tree-division__title my-auto",children:e.nombre})}):t("span",{className:"tree-division tree-division1",children:t("span",{className:"tree-division__title my-auto",children:e.nombre})})})]}),p=="ActividadEconomica"&&x.includes(e.id)&&t("ul",{className:"tree-children actividad-economica",children:B.map((a,c)=>t(O,{children:e.id==a.id_padre_sub_categoria&&t("li",{className:"tree-node draggable",children:f("div",{className:"tree-content actividad-economica",onClick:()=>w(a),children:[t("input",{type:"checkbox",name:"actividad_economica",onChange:()=>w(a),checked:_.includes(a.id)?"checked":""}),t("span",{className:"tree-anchor children",children:t("span",{className:"tree-division tree-division1",children:t(O,{children:t("span",{className:"tree-division__title my-auto",children:a.id+" - "+a.nombre})})})})]})})}))})]})}))})]})}))})]})};export{re as A};
